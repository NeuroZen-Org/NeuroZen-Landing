---
import NeuroZenLogo from "@/assets/images/Principales/Logo.png";
import NeuroZenText from "@/assets/images/Principales/NeuroZen_Texto.png";
import HamburgerLogo from "@/assets/Icons/hamburguesa.svg";
import LanguageSwitcher from "./components/LanguageSwitcher.astro";
import MobileMenu from "./components/MobileMenu.astro";
import menuItems from "@/consts/menu-item";
import { getLangFromUrl, useTranslations } from "@/i18n/utils";

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
---

<header
  class="fixed top-0 left-0 right-0 z-50 flex w-full min-h-[80px] p-5 items-center bg-[#033612]/90 backdrop-blur-md shadow-lg"
>
  <nav class="flex w-full items-center justify-between">
    <div class="flex gap-3 text-2xl items-center text-white">
      <img
        class="w-12 cursor-pointer"
        src={NeuroZenLogo.src}
        alt="NeuroZen Logo"
      />
      <img
        class="w-30 cursor-pointer"
        src={NeuroZenText.src}
        alt="NeuroZen Logo"
      />
    </div>

    <div class="flex gap-4 items-center">
      <ul class="hidden md:flex p-1 gap-2">
        {
          menuItems.map((item) => (
            <li>
              <a
                href={item.href}
                class="menu-item block px-4 py-3 text-white text-lg hover:bg-white/10 rounded-lg transition-all duration-200 hover:-translate-y-2"
              >
                {t(item.name as any)}
              </a>
            </li>
          ))
        }
      </ul>
      <LanguageSwitcher />
      <button
        id="hamburger-btn"
        class="p-2 bg-[#52cf78b6] rounded-md cursor-pointer hover:bg-[#76ca50] transition-all duration-200 hover:scale-105 md:hidden"
        aria-label="Abrir menú"
      >
        <img class="w-6" src={HamburgerLogo.src} alt="Menú" />
      </button>
    </div>
  </nav>
</header>

<!-- Mobile Menu Component -->
<MobileMenu />

<style>
  .menu-item {
    position: relative;
  }

  .menu-item::before {
    content: "";
    position: absolute;
    left: 0;
    bottom: 0;
    transform: translateY(-50%);
    width: 0;
    height: 3px;
    background: #76ca50;
    transition: height 0.2s ease;
  }

  .menu-item:hover::before {
    width: 100%;
  }
</style>

<script>
  const hamburgerBtn = document.getElementById("hamburger-btn");
  const header = document.querySelector("header");

  hamburgerBtn?.addEventListener("click", () => {
    // Llamar a la función global del MobileMenu
    if ((window as any).openMobileMenu) {
      (window as any).openMobileMenu();
    }
  });

  // Agregar sombra al header cuando se hace scroll
  window.addEventListener("scroll", () => {
    if (window.scrollY > 10) {
      header?.classList.add("shadow-2xl");
      header?.classList.remove("shadow-lg");
    } else {
      header?.classList.add("shadow-lg");
      header?.classList.remove("shadow-2xl");
    }
  });
</script>
